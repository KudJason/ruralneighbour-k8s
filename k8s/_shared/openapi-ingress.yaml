apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: openapi-endpoints-ingress
  namespace: ruralneighbour-dev
  annotations:
    nginx.ingress.kubernetes.io/enable-cors: "true"
    nginx.ingress.kubernetes.io/cors-allow-origin: "*"
    nginx.ingress.kubernetes.io/cors-allow-methods: "GET, POST, PUT, DELETE, OPTIONS"
    nginx.ingress.kubernetes.io/cors-allow-headers: "DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization"
    nginx.ingress.kubernetes.io/rewrite-target: /openapi.json
spec:
  rules:
    - http:
        paths:
          # OpenAPI JSON endpoints for each service
          - path: /openapi/auth.json
            pathType: Exact
            backend:
              service:
                name: auth-service
                port:
                  number: 8000
          - path: /openapi/users.json
            pathType: Exact
            backend:
              service:
                name: user-service
                port:
                  number: 8000
          - path: /openapi/locations.json
            pathType: Exact
            backend:
              service:
                name: location-service
                port:
                  number: 8000
          - path: /openapi/requests.json
            pathType: Exact
            backend:
              service:
                name: request-service
                port:
                  number: 8000
          - path: /openapi/payments.json
            pathType: Exact
            backend:
              service:
                name: payment-service
                port:
                  number: 8000
          - path: /openapi/notifications.json
            pathType: Exact
            backend:
              service:
                name: notification-service
                port:
                  number: 8000
          - path: /openapi/content.json
            pathType: Exact
            backend:
              service:
                name: content-service
                port:
                  number: 8000
          - path: /openapi/safety.json
            pathType: Exact
            backend:
              service:
                name: safety-service
                port:
                  number: 8000
          - path: /openapi/investments.json
            pathType: Exact
            backend:
              service:
                name: investment-service
                port:
                  number: 8000
          - path: /openapi/rating.json
            pathType: Exact
            backend:
              service:
                name: rating-service
                port:
                  number: 8000
